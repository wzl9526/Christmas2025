
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Ink Wash Christmas ğŸ„</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Playfair+Display:ital@0;1&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            /* ä»¿å¤å®£çº¸èƒŒæ™¯ */
            background-color: #f4f3ea;
            background-image: linear-gradient(to right, rgba(0,0,0,0.02) 1px, transparent 1px),
                              linear-gradient(to bottom, rgba(0,0,0,0.02) 1px, transparent 1px);
            background-size: 30px 30px; /* æ·¡æ·¡çš„ä¹å®«æ ¼åº•çº¹ */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: 'Playfair Display', 'Noto Serif SC', serif;
        }
        canvas {
            display: block;
        }
        .seal {
            position: absolute;
            bottom: 40px;
            right: 40px;
            width: 80px;
            height: 80px;
            background-color: #a83232; /* å°æ³¥çº¢ */
            color: white;
            border-radius: 4px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Noto Serif SC', serif;
            font-size: 24px;
            line-height: 1.2;
            text-align: center;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
            opacity: 0.9;
            user-select: none;
            cursor: pointer;
        }
        .instruction {
            position: absolute;
            bottom: 20px;
            width: 100%;
            text-align: center;
            color: #888;
            font-size: 12px;
            letter-spacing: 2px;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div class="seal" onclick="location.reload()">åœ£è¯<br>å¿«ä¹</div>
    <div class="instruction">- Click Screen for Blessings -</div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let width, height;

        // --- åŒè¯­è¯­æ–™åº“ (å¤è¯—/æˆè¯­ + è‹±æ–‡æ„è¯‘) ---
        const greetings = [
            { cn: "ç‘é›ªå…†ä¸°å¹´", en: "A Timely Snow Promises a Good Harvest" },
            { cn: "å²å²å¸¸æŸæ¾", en: "Evergreen as the Pine" },
            { cn: "åƒé‡Œå…±å©µå¨Ÿ", en: "Wishing You Peace and Love" },
            { cn: "æµ®ç”ŸåŠæ—¥é—²", en: "Enjoy the Christmas Moment" },
            { cn: "ä¸‡äº‹çš†èƒœæ„", en: "May All Go Well With You" },
            { cn: "åœ£è¯å¿«ä¹", en: "Merry Christmas" },
            { cn: "å¹³å®‰å–œä¹", en: "Joy and Peace" },
            { cn: "ç™½é›ªå¦†é’æ¾", en: "White Snow Decorates the Pine" }
        ];

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            drawScene(); // é‡ç»˜åœºæ™¯
        }
        window.addEventListener('resize', resize);

        // --- æ ¸å¿ƒç»˜åˆ¶é€»è¾‘ ---

        // 1. ç»˜åˆ¶æ°´å¢¨æ¾æ ‘ (åˆ†å½¢é€’å½’)
        function drawInkTree(x, y, len, angle, width_branch, depth) {
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(angle * Math.PI / 180);

            // ç¬”è§¦é£æ ¼ï¼šæ·±å¢¨ç»¿ï¼ŒåŠé€æ˜æ¨¡æ‹Ÿæ°´å¢¨æ™•æŸ“
            // è¶Šå¾€æœ«ç«¯é¢œè‰²è¶Šæµ…
            const r = 20 + depth * 5;
            const g = 40 + depth * 5;
            const b = 30 + depth * 5;
            ctx.strokeStyle = `rgba(${r}, ${g}, ${b}, 0.8)`;
            ctx.fillStyle = `rgba(${r}, ${g}, ${b}, 0.8)`;

            // æ ‘å¹²ä¸æ˜¯ç›´çº¿ï¼Œè€Œæ˜¯åƒæ¯›ç¬”ç”»å‡ºæ¥çš„ä¸‰è§’å½¢
            ctx.beginPath();
            ctx.moveTo(-width_branch/2, 0);
            ctx.lineTo(width_branch/2, 0);
            ctx.lineTo(0, -len);
            ctx.fill();

            // é€’å½’ç»ˆæ­¢
            if (depth <= 0) {
                // æ ‘æ¢¢ç§¯é›ª (ç•™ç™½)
                if (Math.random() > 0.5) {
                    ctx.beginPath();
                    ctx.arc(0, -len, 3, 0, Math.PI*2);
                    ctx.fillStyle = "rgba(255, 255, 255, 0.9)";
                    ctx.fill();
                }
                ctx.restore();
                return;
            }

            // æ¾æ ‘ç‰¹å¾ï¼šä¾§æè§’åº¦è¾ƒå¤§ï¼Œä¸”å‘ä¸Š
            const scale = 0.7;
            drawInkTree(0, -len*0.85, len * scale, -35, width_branch * 0.7, depth - 1);
            drawInkTree(0, -len*0.85, len * scale, 35, width_branch * 0.7, depth - 1);
            // é¡¶ç«¯ä¸»æ
            drawInkTree(0, -len, len * scale, 0, width_branch * 0.8, depth - 1);

            ctx.restore();
        }

        // 2. ç»˜åˆ¶è£…é¥°ç‚¹ (æœ±ç ‚çº¢ç‚¹ï¼Œæ¨¡æ‹Ÿçº¢æœæˆ–ç¯ç¬¼)
        function drawRedDots() {
            const treeBaseX = width / 2;
            const treeBaseY = height - 50;
            // ç®€å•éšæœºåˆ†å¸ƒåœ¨ä¸‰è§’å½¢åŒºåŸŸå†…æ¨¡æ‹Ÿæ ‘ä¸Šçš„è£…é¥°
            for(let i=0; i<60; i++) {
                // ç²—ç•¥çš„ä¸‰è§’å½¢åŒºåŸŸè®¡ç®—
                const yLevel = Math.random(); // 0(åº•) åˆ° 1(é¡¶)
                const yPos = treeBaseY - yLevel * 500;
                const xSpread = (1 - yLevel) * 150; // åº•éƒ¨å®½ï¼Œé¡¶éƒ¨çª„
                const xPos = treeBaseX + (Math.random() - 0.5) * 2 * xSpread;

                ctx.beginPath();
                ctx.arc(xPos, yPos, Math.random() * 3 + 2, 0, Math.PI*2);
                ctx.fillStyle = "#b22222"; // æœ±çº¢
                ctx.shadowBlur = 5;
                ctx.shadowColor = "#b22222";
                ctx.fill();
                ctx.shadowBlur = 0;
            }
        }

        // 3. ç»˜åˆ¶æ–‡å­—æ°”æ³¡ç±»
        class FloatText {
            constructor(x, y, content) {
                this.x = x;
                this.y = y;
                this.content = content; // {cn, en}
                this.alpha = 0;
                this.life = 0;
                this.maxLife = 200;
                this.vy = -0.5; // å‘ä¸Šé£˜
            }
            update() {
                this.y += this.vy;
                this.life++;
                // æ·¡å…¥æ·¡å‡º
                if (this.life < 30) this.alpha = this.life / 30;
                else if (this.life > 150) this.alpha = (200 - this.life) / 50;
                else this.alpha = 1;
            }
            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.textAlign = "center";

                // ä¸­æ–‡
                ctx.font = "bold 28px 'Noto Serif SC', serif";
                ctx.fillStyle = "#2c3e50"; // å¢¨è‰²
                ctx.fillText(this.content.cn, this.x, this.y);

                // è‹±æ–‡
                ctx.font = "italic 16px 'Playfair Display', serif";
                ctx.fillStyle = "#8b0000"; // æ·±çº¢
                ctx.fillText(this.content.en, this.x, this.y + 25);

                // è£…é¥°çº¿
                ctx.beginPath();
                ctx.moveTo(this.x - 20, this.y + 10);
                ctx.lineTo(this.x + 20, this.y + 10);
                ctx.strokeStyle = "rgba(0,0,0,0.1)";
                ctx.stroke();

                ctx.restore();
            }
        }

        // --- åŠ¨ç”»å¾ªç¯ ---
        const texts = [];
        let time = 0;

        function drawScene() {
            // èƒŒæ™¯æ¸…ç©ºï¼ˆå¸¦ä¸€ç‚¹é€æ˜åº¦ï¼Œå½¢æˆæ‹–å°¾æ•ˆæœï¼Œæˆ–è€…å®Œå…¨æ¸…ç©ºï¼‰
            // è¿™é‡Œæˆ‘ä»¬æ¯å¸§å®Œå…¨é‡ç»˜èƒŒæ™¯å›¾å±‚ï¼Œä¸åŠ¨æ ‘
            ctx.clearRect(0, 0, width, height);

            // 1. é™æ€ç»˜åˆ¶æ ‘ (æ¯ä¸€å¸§éƒ½ç”»æ ‘å…¶å®æµªè´¹æ€§èƒ½ï¼Œä½†ä¸ºäº†ç®€å•é€»è¾‘)
            // åœ¨å®é™…å¤æ‚é¡¹ç›®ä¸­åº”ä½¿ç”¨ç¦»å± Canvas
            // è¿™é‡Œä¸ºäº†è®©æ ‘çœ‹èµ·æ¥åƒ"é™æ­¢çš„æ°´å¢¨ç”»"ï¼Œæˆ‘ä»¬å›ºå®šå‚æ•°
            drawInkTree(width/2, height - 50, 120, 0, 20, 10);
            drawRedDots(); // æ³¨æ„ï¼šè¿™ä¼šè®©çº¢ç‚¹é—ªçƒï¼Œå› ä¸ºæ˜¯éšæœºçš„ã€‚
            // ä¿®æ­£ï¼šæˆ‘ä»¬éœ€è¦çº¢ç‚¹å›ºå®šã€‚
            // ç®€å•å¤„ç†ï¼šåœ¨ animate å¤–é¢ç”Ÿæˆçº¢ç‚¹ä½ç½®ï¼Ÿ
            // é‰´äºç¯‡å¹…ï¼Œæˆ‘ä»¬æ¥å—çº¢ç‚¹é—ªçƒï¼Œè¿™çœ‹èµ·æ¥åƒéœ“è™¹ç¯ã€‚
        }

        // ä¿®æ­£ï¼šå°†æ ‘å’ŒèƒŒæ™¯ä½œä¸ºé™æ€å±‚
        let bgCanvas = document.createElement('canvas');
        let bgCtx = bgCanvas.getContext('2d');
        let bgReady = false;

        function prepareBackground() {
            bgCanvas.width = width;
            bgCanvas.height = height;

            // ç”»æ ‘
            // åŠ«æŒ ctx ç»˜åˆ¶åˆ° bgCtx
            const tempCtx = ctx; 
            // drawInkTree éœ€è¦ç”¨ bgCtx
            // è¿™é‡Œä¸ºäº†ç®€å•ï¼Œç›´æ¥æŠŠä»£ç é‡Œçš„ ctx æ¢æˆ bgCtx ä¸å¤ªè¡Œ
            // æˆ‘ä»¬é‡æ–°å®šä¹‰ä¸€ä¸ªç»˜åˆ¶å‡½æ•°ä¼ å…¥ context
            drawTreeOnContext(bgCtx, width/2, height-50, 120, 0, 20, 10);

            // ç”»å›ºå®šçš„çº¢ç‚¹
            const treeBaseX = width / 2;
            const treeBaseY = height - 50;
            for(let i=0; i<50; i++) {
                const yLevel = Math.random(); 
                const yPos = treeBaseY - yLevel * 450;
                const xSpread = (1 - yLevel) * 120; 
                const xPos = treeBaseX + (Math.random() - 0.5) * 2 * xSpread;
                bgCtx.beginPath();
                bgCtx.arc(xPos, yPos, Math.random() * 3 + 1, 0, Math.PI*2);
                bgCtx.fillStyle = "#b22222"; 
                bgCtx.fill();
            }

            bgReady = true;
        }

        function drawTreeOnContext(c, x, y, len, angle, w, d) {
            c.save();
            c.translate(x, y);
            c.rotate(angle * Math.PI / 180);
            const r = 20 + d * 5; const g = 45 + d * 5; const b = 35 + d * 5;
            c.fillStyle = `rgba(${r}, ${g}, ${b}, 0.85)`;
            c.beginPath();
            c.moveTo(-w/2, 0); c.lineTo(w/2, 0); c.lineTo(0, -len);
            c.fill();
            if (d <= 0) { c.restore(); return; }
            const s = 0.75;
            drawTreeOnContext(c, 0, -len*0.9, len*s, -30, w*0.7, d-1);
            drawTreeOnContext(c, 0, -len*0.9, len*s, 30, w*0.7, d-1);
            drawTreeOnContext(c, 0, -len, len*s, 0, w*0.8, d-1);
            c.restore();
        }

        // --- ä¸»å¾ªç¯ ---
        function animate() {
            if (!bgReady) prepareBackground();

            ctx.clearRect(0, 0, width, height);

            // 1. ç”»èƒŒæ™¯å›¾å±‚
            ctx.drawImage(bgCanvas, 0, 0);

            // 2. ä¸‹é›ª (å¢¨ç‚¹é›ª)
            if (Math.random() > 0.9) {
                // ç®€æ˜“æ¨¡æ‹Ÿï¼Œä¸éœ€è¦å¤æ‚ç²’å­ç³»ç»Ÿ
                // ä¹Ÿå¯ä»¥ç•¥è¿‡ä¿æŒç”»é¢å¹²å‡€
            }

            // 3. æ›´æ–°æ–‡å­—
            for (let i = texts.length - 1; i >= 0; i--) {
                const t = texts[i];
                t.update();
                t.draw();
                if (t.life > t.maxLife) texts.splice(i, 1);
            }

            requestAnimationFrame(animate);
        }

        // --- äº¤äº’ ---
        document.body.addEventListener('click', (e) => {
            // åœ¨ç‚¹å‡»ä½ç½®ç”ŸæˆåŒè¯­ç¥ç¦
            const randomMsg = greetings[Math.floor(Math.random() * greetings.length)];
            texts.push(new FloatText(e.clientX, e.clientY, randomMsg));
        });

        // è‡ªåŠ¨æ’­æ”¾å‡ ä¸ª
        setTimeout(() => texts.push(new FloatText(width/2, height/2, greetings[0])), 500);

        resize();
        animate();
    </script>
</body>
</html>
